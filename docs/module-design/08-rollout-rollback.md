# 模块设计 08 - Rollout & Rollback

## 发布阶段
1. 本地开发环境
- 合约本地测试 + API 本地 SQLite
2. Fuji 测试网
- 部署三合约，绑定 settlement 地址
3. 演示环境
- 固定 API Key、固定演示事件模板

## 上线前检查
1. 合约 ABI 与 API DTO 对齐。
2. settle/claim 权限回归通过。
3. 审计接口复算一致率 100%。

## 回滚触发条件
1. 结算结果明显异常（公式错误或重复结算）。
2. 审计不一致率 > 0。
3. 核心接口成功率低于目标阈值。

## 回滚动作
1. 暂停新事件创建。
2. 临时下线 `POST /settle/{event_id}`。
3. 回退到上一合约部署版本与上一服务镜像。
4. 使用索引库回放并修复受影响事件。
