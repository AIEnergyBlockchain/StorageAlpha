# ADR 0001: DR-Agent MVP 架构边界

- 日期：2026-02-17
- 状态：已接受 (accepted)

## 背景 (Context)

DR-Agent 旨在交付一个适用于黑客松、具备需求响应结算功能的 MVP（最小可行性产品）。该产品必须易于演示、验证且具备可扩展性。项目需支持快速的本地反馈循环，同时保留可审计的结算语义。

## 决策 (Decision)

1. **链上部分**：使用三个智能合约管理事件生命周期和结算核心状态：

   - `EventManager.sol`（事件管理器）
   - `ProofRegistry.sol`（证明注册表）
   - `Settlement.sol`（结算合约）

2. **链下部分**：将高频遥测数据处理和负载装配保留在链下：

   - 使用 FastAPI/Python 服务处理基准线（Baseline）和证明负载（Proof Payloads）。
   - 使用 SQLite 存储 MVP 循环中的事件/证明/结算索引。

3. **环境隔离**：分离“部署就绪”与“本地演示就绪”状态：
   - 将本地循环作为默认开发路径。
   - Fuji 测试网部署保持凭证隔离（受 `PRIVATE_KEY` 和测试 AVAX 限制），并在专用部署记录中进行跟踪。

## 后果 (Consequences)

**正面影响：**

- 能够快速上手并实现可复现的本地演示流程。
- 在可验证的链上事实与链下计算之间建立了清晰的信任边界。
- 极大简化了黑客松迭代期间的组件复杂度。

**权衡 (Tradeoffs)：**

- 在真实的测试网部署成功前，README 中的链上证明部分无法完整填充。
- SQLite 对 MVP 来说足够，但并非生产级的多租户持久化方案。

## 后续行动 (Follow-up)

1. 在成功部署后，记录真实的 Fuji 合约地址和区块浏览器链接。
2. 在第一个稳定发布分支之后，引入更严格的 CI（持续集成）检查。
3. 扩展 ADR 集合，涵盖身份认证加固和生产级数据架构。
